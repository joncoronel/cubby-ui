{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "pull-down-menu",
  "type": "registry:ui",
  "title": "Pull Down Menu",
  "description": "A pull-down-menu component.",
  "dependencies": [
    "motion"
  ],
  "files": [
    {
      "path": "registry/default/pull-down-menu/pull-down-menu.tsx",
      "content": "\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport { Menu as BaseMenu } from \"@base-ui/react/menu\";\r\nimport { m, useReducedMotion } from \"motion/react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\n// Context for sharing state between components\r\ntype PullDownMenuContextValue = {\r\n  open: boolean;\r\n  reducedMotion: boolean;\r\n};\r\n\r\nconst PullDownMenuContext =\r\n  React.createContext<PullDownMenuContextValue | null>(null);\r\n\r\nfunction usePullDownMenu() {\r\n  const context = React.useContext(PullDownMenuContext);\r\n  if (!context) {\r\n    throw new Error(\"PullDownMenu components must be used within PullDownMenu\");\r\n  }\r\n  return context;\r\n}\r\n\r\n// Animation configuration - following Bloom's spring config\r\nconst springTransition = {\r\n  type: \"spring\" as const,\r\n  visualDuration: 0.25,\r\n  bounce: 0.2,\r\n};\r\n\r\n// Crossfade transition for content\r\nconst fadeTransition = {\r\n  duration: 0.15,\r\n  ease: [0.32, 0.72, 0, 1] as const,\r\n};\r\n\r\n// Root component\r\ntype PullDownMenuProps = Omit<\r\n  React.ComponentProps<typeof BaseMenu.Root>,\r\n  \"open\" | \"onOpenChange\" | \"children\"\r\n> & {\r\n  children: React.ReactNode;\r\n  open?: boolean;\r\n  onOpenChange?: (open: boolean) => void;\r\n  defaultOpen?: boolean;\r\n};\r\n\r\nfunction PullDownMenu({\r\n  children,\r\n  open: controlledOpen,\r\n  onOpenChange,\r\n  defaultOpen = false,\r\n  ...props\r\n}: PullDownMenuProps) {\r\n  const [internalOpen, setInternalOpen] = React.useState(defaultOpen);\r\n  const reducedMotion = useReducedMotion() ?? false;\r\n\r\n  const isControlled = controlledOpen !== undefined;\r\n  const open = isControlled ? controlledOpen : internalOpen;\r\n\r\n  const handleOpenChange = React.useCallback(\r\n    (nextOpen: boolean) => {\r\n      if (!isControlled) {\r\n        setInternalOpen(nextOpen);\r\n      }\r\n      onOpenChange?.(nextOpen);\r\n    },\r\n    [isControlled, onOpenChange],\r\n  );\r\n\r\n  const contextValue = React.useMemo(\r\n    () => ({\r\n      open,\r\n      reducedMotion,\r\n    }),\r\n    [open, reducedMotion],\r\n  );\r\n\r\n  return (\r\n    <BaseMenu.Root {...props} open={open} onOpenChange={handleOpenChange}>\r\n      <PullDownMenuContext.Provider value={contextValue}>\r\n        <div data-slot=\"pull-down-menu\" className=\"relative inline-block\">\r\n          {children}\r\n        </div>\r\n      </PullDownMenuContext.Provider>\r\n    </BaseMenu.Root>\r\n  );\r\n}\r\n\r\n// Content component - handles the morphing animation (Bloom pattern)\r\ntype PullDownMenuContentProps = {\r\n  trigger: React.ReactNode;\r\n  children: React.ReactNode;\r\n  className?: string;\r\n  triggerClassName?: string;\r\n};\r\n\r\n// Constants for button dimensions (matching trigger styles)\r\nconst BUTTON_BORDER_RADIUS = 8; // rounded-lg\r\nconst MENU_BORDER_RADIUS = 12; // rounded-xl\r\nconst MIN_MENU_WIDTH = 192; // min-w-[12rem]\r\n\r\nfunction PullDownMenuContent({\r\n  trigger,\r\n  children,\r\n  className,\r\n  triggerClassName,\r\n}: PullDownMenuContentProps) {\r\n  const { open, reducedMotion } = usePullDownMenu();\r\n  const triggerRef = React.useRef<HTMLButtonElement>(null);\r\n  const buttonMeasureRef = React.useRef<HTMLDivElement>(null);\r\n  const menuMeasureRef = React.useRef<HTMLDivElement>(null);\r\n\r\n  // Track dimensions for morphing\r\n  const [dimensions, setDimensions] = React.useState({\r\n    buttonWidth: 0,\r\n    buttonHeight: 0,\r\n    menuWidth: MIN_MENU_WIDTH,\r\n    menuHeight: 0,\r\n  });\r\n\r\n  // Measure button from hidden measurement container\r\n  React.useLayoutEffect(() => {\r\n    if (buttonMeasureRef.current) {\r\n      const rect = buttonMeasureRef.current.getBoundingClientRect();\r\n      setDimensions((d) => ({\r\n        ...d,\r\n        buttonWidth: rect.width,\r\n        buttonHeight: rect.height,\r\n      }));\r\n    }\r\n  }, [trigger]);\r\n\r\n  // Measure menu content from hidden measurement container\r\n  React.useLayoutEffect(() => {\r\n    if (menuMeasureRef.current) {\r\n      const rect = menuMeasureRef.current.getBoundingClientRect();\r\n      setDimensions((d) => ({\r\n        ...d,\r\n        menuWidth: Math.max(rect.width, MIN_MENU_WIDTH),\r\n        menuHeight: rect.height,\r\n      }));\r\n    }\r\n  }, [children]);\r\n\r\n  // For reduced motion, use simple fade animation\r\n  if (reducedMotion) {\r\n    return (\r\n      <>\r\n        <BaseMenu.Trigger\r\n          ref={triggerRef}\r\n          data-slot=\"pull-down-menu-trigger\"\r\n          className={cn(\r\n            \"bg-popover text-popover-foreground inline-flex cursor-pointer items-center justify-center rounded-lg border px-3 py-2 text-sm font-medium shadow-sm transition-colors\",\r\n            \"hover:bg-accent/50 focus-visible:ring-ring focus-visible:ring-2 focus-visible:outline-none\",\r\n            triggerClassName,\r\n          )}\r\n        >\r\n          {trigger}\r\n        </BaseMenu.Trigger>\r\n        <BaseMenu.Portal>\r\n          <BaseMenu.Positioner\r\n            anchor={triggerRef}\r\n            sideOffset={0}\r\n            align=\"start\"\r\n            className=\"z-50\"\r\n          >\r\n            <BaseMenu.Popup\r\n              data-slot=\"pull-down-menu-content\"\r\n              className={cn(\r\n                \"bg-popover text-popover-foreground min-w-[12rem] overflow-hidden rounded-xl border p-1 shadow-[0_8px_20px_0_oklch(0.18_0_0/0.10)]\",\r\n                \"origin-(--transform-origin) transition-[transform,scale,opacity] duration-150\",\r\n                \"data-starting-style:scale-95 data-starting-style:opacity-0\",\r\n                \"data-ending-style:scale-95 data-ending-style:opacity-0\",\r\n                className,\r\n              )}\r\n            >\r\n              {children}\r\n            </BaseMenu.Popup>\r\n          </BaseMenu.Positioner>\r\n        </BaseMenu.Portal>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Check if we have valid dimensions for morphing\r\n  const hasDimensions = dimensions.buttonWidth > 0 && dimensions.buttonHeight > 0;\r\n\r\n  // Full morph animation - single container morphs, content crossfades inside\r\n  return (\r\n    <>\r\n      {/* Hidden trigger for Base UI - becomes invisible when menu opens */}\r\n      <BaseMenu.Trigger\r\n        ref={triggerRef}\r\n        data-slot=\"pull-down-menu-trigger\"\r\n        className={cn(\r\n          \"bg-popover text-popover-foreground inline-flex cursor-pointer items-center justify-center rounded-lg border px-3 py-2 text-sm font-medium shadow-sm transition-colors\",\r\n          \"hover:bg-accent/50 focus-visible:ring-ring focus-visible:ring-2 focus-visible:outline-none\",\r\n          open && \"invisible\",\r\n          triggerClassName,\r\n        )}\r\n      >\r\n        {trigger}\r\n      </BaseMenu.Trigger>\r\n\r\n      {/* Portal with morphing container - always visible, positioned over trigger */}\r\n      <BaseMenu.Portal keepMounted>\r\n        <BaseMenu.Positioner\r\n          anchor={triggerRef}\r\n          sideOffset={-dimensions.buttonHeight}\r\n          align=\"start\"\r\n          side=\"bottom\"\r\n          className=\"z-50\"\r\n        >\r\n          {/* Morphing container - morphs between button and menu sizes */}\r\n          {hasDimensions && (\r\n            <m.div\r\n              initial={false}\r\n              animate={{\r\n                width: open ? dimensions.menuWidth : dimensions.buttonWidth,\r\n                height: open ? dimensions.menuHeight : dimensions.buttonHeight,\r\n                borderRadius: open ? MENU_BORDER_RADIUS : BUTTON_BORDER_RADIUS,\r\n              }}\r\n              transition={springTransition}\r\n              className={cn(\r\n                \"bg-popover relative overflow-hidden border\",\r\n                open ? \"shadow-[0_8px_20px_0_oklch(0.18_0_0/0.10)]\" : \"shadow-sm\",\r\n              )}\r\n              style={{\r\n                willChange: \"width, height, border-radius\",\r\n              }}\r\n            >\r\n              {/* Trigger content - visible when closed */}\r\n              <m.div\r\n                initial={false}\r\n                animate={{\r\n                  opacity: open ? 0 : 1,\r\n                  filter: open ? \"blur(8px)\" : \"blur(0px)\",\r\n                }}\r\n                transition={fadeTransition}\r\n                className=\"absolute inset-0 flex items-center justify-center px-3 py-2 text-sm font-medium\"\r\n                style={{ pointerEvents: open ? \"none\" : \"auto\" }}\r\n                onClick={() => triggerRef.current?.click()}\r\n              >\r\n                {trigger}\r\n              </m.div>\r\n\r\n              {/* Menu content - visible when open */}\r\n              <m.div\r\n                initial={false}\r\n                animate={{\r\n                  opacity: open ? 1 : 0,\r\n                  filter: open ? \"blur(0px)\" : \"blur(8px)\",\r\n                }}\r\n                transition={fadeTransition}\r\n                style={{ pointerEvents: open ? \"auto\" : \"none\" }}\r\n              >\r\n                <BaseMenu.Popup\r\n                  data-slot=\"pull-down-menu-content\"\r\n                  className={cn(\"text-popover-foreground min-w-[12rem] p-1\", className)}\r\n                >\r\n                  {children}\r\n                </BaseMenu.Popup>\r\n              </m.div>\r\n            </m.div>\r\n          )}\r\n        </BaseMenu.Positioner>\r\n      </BaseMenu.Portal>\r\n\r\n      {/* Hidden measurement containers */}\r\n      <div\r\n        ref={buttonMeasureRef}\r\n        aria-hidden\r\n        style={{ position: \"fixed\", top: -9999, left: -9999, visibility: \"hidden\" }}\r\n        className={cn(\r\n          \"pointer-events-none inline-flex items-center justify-center rounded-lg border px-3 py-2 text-sm font-medium\",\r\n          triggerClassName,\r\n        )}\r\n      >\r\n        {trigger}\r\n      </div>\r\n      <div\r\n        ref={menuMeasureRef}\r\n        aria-hidden\r\n        style={{ position: \"fixed\", top: -9999, left: -9999, visibility: \"hidden\" }}\r\n        className={cn(\"pointer-events-none min-w-[12rem] p-1\", className)}\r\n      >\r\n        {children}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\n// Menu item\r\ntype PullDownMenuItemProps = React.ComponentProps<typeof BaseMenu.Item> & {\r\n  inset?: boolean;\r\n  variant?: \"default\" | \"destructive\";\r\n};\r\n\r\nfunction PullDownMenuItem({\r\n  className,\r\n  inset,\r\n  variant = \"default\",\r\n  ...props\r\n}: PullDownMenuItemProps) {\r\n  return (\r\n    <BaseMenu.Item\r\n      data-slot=\"pull-down-menu-item\"\r\n      data-inset={inset}\r\n      data-variant={variant}\r\n      className={cn(\r\n        \"data-highlighted:bg-accent/50 data-highlighted:text-accent-foreground relative flex cursor-default items-center gap-2 rounded-md px-2.5 py-1.5 text-sm outline-hidden select-none data-disabled:pointer-events-none data-disabled:opacity-50 data-inset:pl-8\",\r\n        \"data-[variant=destructive]:text-destructive data-[variant=destructive]:data-highlighted:bg-destructive/20\",\r\n        \"[&_svg:not([class*='text-'])]:text-muted-foreground [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n// Separator\r\ntype PullDownMenuSeparatorProps = React.ComponentProps<\r\n  typeof BaseMenu.Separator\r\n>;\r\n\r\nfunction PullDownMenuSeparator({\r\n  className,\r\n  ...props\r\n}: PullDownMenuSeparatorProps) {\r\n  return (\r\n    <BaseMenu.Separator\r\n      data-slot=\"pull-down-menu-separator\"\r\n      className={cn(\"bg-border -mx-1 my-1 h-px\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n// Label for groups\r\ntype PullDownMenuLabelProps = React.ComponentProps<\"div\"> & {\r\n  inset?: boolean;\r\n};\r\n\r\nfunction PullDownMenuLabel({\r\n  className,\r\n  inset,\r\n  ...props\r\n}: PullDownMenuLabelProps) {\r\n  return (\r\n    <div\r\n      data-slot=\"pull-down-menu-label\"\r\n      data-inset={inset}\r\n      className={cn(\r\n        \"px-2.5 py-1.5 text-xs font-medium data-[inset]:pl-8\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n// Group\r\ntype PullDownMenuGroupProps = React.ComponentProps<typeof BaseMenu.Group>;\r\n\r\nfunction PullDownMenuGroup({ ...props }: PullDownMenuGroupProps) {\r\n  return <BaseMenu.Group data-slot=\"pull-down-menu-group\" {...props} />;\r\n}\r\n\r\n// Group label\r\ntype PullDownMenuGroupLabelProps = React.ComponentProps<\r\n  typeof BaseMenu.GroupLabel\r\n> & {\r\n  inset?: boolean;\r\n};\r\n\r\nfunction PullDownMenuGroupLabel({\r\n  className,\r\n  inset,\r\n  ...props\r\n}: PullDownMenuGroupLabelProps) {\r\n  return (\r\n    <BaseMenu.GroupLabel\r\n      data-slot=\"pull-down-menu-group-label\"\r\n      data-inset={inset}\r\n      className={cn(\r\n        \"px-2.5 py-1.5 text-xs font-medium data-[inset]:pl-8\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\n// Shortcut display\r\ntype PullDownMenuShortcutProps = React.ComponentProps<\"span\">;\r\n\r\nfunction PullDownMenuShortcut({\r\n  className,\r\n  ...props\r\n}: PullDownMenuShortcutProps) {\r\n  return (\r\n    <span\r\n      data-slot=\"pull-down-menu-shortcut\"\r\n      className={cn(\r\n        \"text-muted-foreground ml-auto text-xs tracking-widest\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  PullDownMenu,\r\n  PullDownMenuContent,\r\n  PullDownMenuItem,\r\n  PullDownMenuSeparator,\r\n  PullDownMenuLabel,\r\n  PullDownMenuGroup,\r\n  PullDownMenuGroupLabel,\r\n  PullDownMenuShortcut,\r\n};\r\n",
      "type": "registry:ui",
      "target": "components/ui/cubby-ui/pull-down-menu.tsx"
    }
  ]
}