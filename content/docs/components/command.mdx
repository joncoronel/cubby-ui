---
title: Command
description: Fast, composable command menu for keyboard-first navigation and actions
---

## Preview

<ComponentPreview component="command" example="command-basic-command-menu" />

## Installation

<ComponentInstall component="command" />

## Usage

<ComponentUsage component="command" />

## Examples

### Command Dialog

Display command menu in a modal dialog with keyboard shortcut support.

<ComponentPreview component="command" example="command-command-dialog" />

### With Footer

Add footer content with keyboard navigation hints.

<ComponentPreview component="command" example="command-with-footer" />

### Fuzzy Search

Enable fuzzy matching for more flexible searching across multiple fields.

<ComponentPreview component="command" example="command-fuzzy" />

### Virtualized

Use virtualization for large lists (100+ items) to maintain smooth performance. Only renders items visible in the viewport, dramatically reducing DOM nodes.

<ComponentPreview component="command" example="command-virtualized" />

**Key concepts:**

1. **Use `useListVirtualizer` hook** - Handles scroll positioning, keyboard navigation, and item measurement. See [useListVirtualizer docs](/docs/hooks/use-list-virtualizer) for full API reference.
2. **External filtering** - Compute `filteredItems` yourself and pass `filter={null}` to Command. The hook needs both arrays to calculate proper aria attributes.
3. **Replace `CommandList` with `CommandVirtualizedList`** - Accepts `scrollRef` and `totalSize` from the hook.
4. **Spread `rootProps`** - Contains virtualization state for Base UI integration.

```tsx
import { useListVirtualizer } from "@/hooks/cubby-ui/use-list-virtualizer";
import { useCommandFilter } from "@/lib/cubby-ui/command";

// Helper to extract searchable text from items
const getItemLabel = (item: Item | null) => item?.name ?? "";

// 1. Set up filtering with deferred value for performance
const { contains } = useCommandFilter();
const deferredQuery = useDeferredValue(query);
const resolvedQuery =
  query === "" || deferredQuery === "" ? query : deferredQuery;
const filteredItems = useMemo(
  () => items.filter((item) => contains(item, resolvedQuery, getItemLabel)),
  [contains, resolvedQuery],
);

// 2. Initialize virtualizer
const {
  rootProps, // Spread on Command
  scrollRef, // Pass to CommandVirtualizedList
  measureRef, // Pass to each CommandItem
  totalSize, // Pass to CommandVirtualizedList
  virtualItems, // Array to map over
  getItem, // Get data for virtual item
  getItemStyle, // Get positioning styles
  getItemProps, // Get aria attributes
} = useListVirtualizer({
  items, // All items (for aria-setsize)
  filteredItems, // Items to display
  estimateSize: 40, // Item height in px
});

// 3. Render
<Command {...rootProps} filter={null} itemToStringValue={getItemLabel}>
  <CommandVirtualizedList
    scrollRef={scrollRef}
    totalSize={totalSize}
    nativeScroll
  >
    {virtualItems.map((virtualItem) => (
      <CommandItem
        key={virtualItem.key}
        ref={measureRef}
        value={getItem(virtualItem)}
        style={getItemStyle(virtualItem)}
        {...getItemProps(virtualItem)}
      >
        {getItem(virtualItem)?.name}
      </CommandItem>
    ))}
  </CommandVirtualizedList>
</Command>;
```

**Filtering options:**

- **Default filtering**: Use `useCommandFilter` for the same `contains`/`startsWith`/`endsWith` matchers as Command's built-in filter
- **Fuzzy search**: Use [useFuzzyFilter](/docs/hooks/use-fuzzy-filter) for relevance-sorted results across multiple fields
- **Server-side filtering**: Pass the same array to both `items` and `filteredItems`
- **Custom filtering**: Use any filtering method (native `.filter()`, third-party libraries, etc.)

## API Reference

The Command component is built on top of [Base UI's Autocomplete](https://base-ui.com/react/components/autocomplete) and [Dialog](https://base-ui.com/react/components/dialog). All Base UI props are supported. The documentation below only covers custom props and modified defaults specific to our implementation.

For the complete Base UI API, see the [Base UI Autocomplete documentation](https://base-ui.com/react/components/autocomplete).

### Props

#### Command

Root component that manages command menu state and keyboard navigation. Wraps Base UI's `Autocomplete.Root`.

<ApiPropsList>

<ApiProp
  name="items"
  fullType="T[] | { items: T[] }[]"
  simpleType="array"
  defaultValue="[]"
>
  Array of items or grouped items to display. Used with the collection pattern
  where `CommandList`, `CommandGroup`, and `CommandCollection` receive render
  functions as children.
</ApiProp>

<ApiProp
  name="autoHighlight"
  fullType='boolean | "always"'
  defaultValue='"always"'
>
  Whether the first matching item is highlighted automatically. Set to
  `"always"` to ensure an item is always highlighted during keyboard navigation.
  Base UI defaults to `false`.
</ApiProp>

<ApiProp name="open" fullType="boolean" defaultValue="true">
  Keeps the autocomplete list always open. Appropriate for command menu behavior
  where the list is always visible. Base UI defaults to `false`.
</ApiProp>

<ApiProp name="keepHighlight" fullType="boolean" defaultValue="true">
  Whether the highlighted item should be preserved when the pointer leaves the
  list. Prevents the highlight from going to a "null" state during navigation.
  Base UI defaults to `false`.
</ApiProp>

</ApiPropsList>

#### CommandList

Scrollable container for command items with empty state handling. Wraps Base UI's `Autocomplete.List`.

<ApiPropsList>

<ApiProp
  name="emptyMessage"
  fullType="ReactNode"
  simpleType="node"
  defaultValue='"No results found."'
>
  Custom prop not available in Base UI. Message shown when no results are found
  in the command list.
</ApiProp>

<ApiProp name="nativeScroll" fullType="boolean" defaultValue="false">
  Use native browser scrolling with styled scrollbars instead of Base UI's
  scroll virtualization. Enables CSS scroll-driven animations for fade edges.
</ApiProp>

<ApiProp
  name="fadeEdges"
  fullType="boolean | 'top' | 'bottom' | 'left' | 'right' | 'x' | 'y' | FadeEdge[]"
  defaultValue="true"
>
  Controls the fade effect on scroll edges. See
  [ScrollArea](/docs/components/scroll-area#custom-props) for all options.
</ApiProp>

<ApiProp name="scrollbarGutter" fullType="boolean" defaultValue="false">
  Reserves space for the scrollbar when content overflows, preventing layout
  shift.
</ApiProp>

<ApiProp name="persistScrollbar" fullType="boolean" defaultValue="false">
  Always show the scrollbar instead of fading it in on hover or scroll.
</ApiProp>

<ApiProp name="hideScrollbar" fullType="boolean" defaultValue="false">
  Hides the scrollbar while keeping scroll functionality.
</ApiProp>

</ApiPropsList>

#### CommandVirtualizedList

Virtualized scrollable container for large lists. Use with `useListVirtualizer` hook for optimal performance with 100+ items.

<ApiPropsList>

<ApiProp
  name="scrollRef"
  fullType="(element: HTMLDivElement | null) => void"
  required
>
  Ref callback from `useListVirtualizer` for the scroll container.
</ApiProp>

<ApiProp name="totalSize" fullType="number" required>
  Total height of all virtual items in pixels. Provided by `useListVirtualizer`.
</ApiProp>

<ApiProp
  name="emptyMessage"
  fullType="ReactNode"
  simpleType="node"
  defaultValue='"No results found."'
>
  Message shown when no results are found.
</ApiProp>

<ApiProp
  name="fadeEdges"
  fullType="boolean | 'x' | 'y' | FadeEdge[]"
  defaultValue='"y"'
>
  Controls the fade effect on scroll edges.
</ApiProp>

<ApiProp name="nativeScroll" fullType="boolean" defaultValue="false">
  Use native browser scrolling instead of custom scrollbars.
</ApiProp>

</ApiPropsList>

### Utilities

#### highlightText

Highlights matching portions of text by wrapping them in `<mark>` tags. Useful for showing which parts of a command match the user's input.

See [highlightText](/docs/utils/highlight-text) for full documentation and API reference.

### Hooks

#### useCommandFilter

```ts
function useCommandFilter(): {
  contains: (
    item: T,
    query: string,
    getItemLabel: (item: T) => string,
  ) => boolean;
  startsWith: (
    item: T,
    query: string,
    getItemLabel: (item: T) => string,
  ) => boolean;
  endsWith: (
    item: T,
    query: string,
    getItemLabel: (item: T) => string,
  ) => boolean;
};
```

Exposes Base UI's built-in filter matchers for external filtering. Required when using virtualization since you must compute `filteredItems` yourself.

**Returns**

| Property     | Type                                     | Description                                                  |
| ------------ | ---------------------------------------- | ------------------------------------------------------------ |
| `contains`   | `(item, query, getItemLabel) => boolean` | Returns true if item label contains query (case-insensitive) |
| `startsWith` | `(item, query, getItemLabel) => boolean` | Returns true if item label starts with query                 |
| `endsWith`   | `(item, query, getItemLabel) => boolean` | Returns true if item label ends with query                   |

```tsx
import { useCommandFilter } from "@/registry/default/command/command";

const { contains } = useCommandFilter();
const getItemLabel = (item: Item | null) => item?.name ?? "";

const filteredItems = useMemo(
  () => items.filter((item) => contains(item, query, getItemLabel)),
  [contains, query],
);
```

#### useFuzzyFilter

Provides fuzzy matching capabilities for flexible searching across multiple fields. Returns filter functions compatible with Base UI's Autocomplete.

See [useFuzzyFilter](/docs/hooks/use-fuzzy-filter) for full documentation and API reference.

#### useListVirtualizer

Provides virtualization for large command lists using TanStack Virtual. Abstracts scroll handling, item positioning, and keyboard navigation.

See [useListVirtualizer](/docs/hooks/use-list-virtualizer) for full documentation and API reference.
